<% classname ||= "" %>
<% if current_user %>

  <% if current_user.user_profiles.length > 1 %>
    <li class="dropdown" class="<%= classname %>"><a href="#" class="dropdown-toggle" data-toggle="dropdown"><%= user_profile.name.truncate(20, separator: ' ') %> <b class="caret"></b></a>
      <ul class="dropdown-menu">
        <% current_user.user_profiles.keep_if{ |profile| profile.id != user_profile.id }.each do |profile| %>
          <% menu_list_item(profile.name, set_user_profile_path(profile))%>
        <% end %>
      </ul>
    </li>
  <% else %>
    <% menu_list_item(user_profile.name, "#", "disabled #{classname}") %>
  <% end %>
  
  
  <li class="dropdown <%= active_class_if([destroy_user_session_path,new_user_session_path]) %> <%= classname %>">
    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
      Hello <%= current_user.name.truncate(20, separator: ' ') %>
      <b class="caret"></b></a>
    <ul class="dropdown-menu">
      <% menu_list_item("Your Profiles", user_profiles_path) %>
      <li class="divider"></li>
      <% menu_list_item("Logout", destroy_user_session_path) %>
    </ul>
  </li>
<% else %>
  <li class="<%= classname %>"><%= link_to("Login", new_user_session_path) %></li>
<% end %>